!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=8)}([function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},function(e,t,r){var n=r(5),o=r(6);e.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?o(e):t}},function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(t)}e.exports=r},function(e,t,r){var n=r(7);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},function(e,t){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(t){return"function"==typeof Symbol&&"symbol"===r(Symbol.iterator)?e.exports=n=function(e){return r(e)}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":r(e)},n(t)}e.exports=n},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){function r(t,n){return e.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(t,n)}e.exports=r},function(e,t,r){"use strict";r.r(t);var n=r(0),o=r.n(n),i=r(1),s=r.n(i),u=r(2),c=r.n(u),a=r(3),f=r.n(a),l=r(4),v=r.n(l),p=function(){function e(){o()(this,e),this.events=[]}return s()(e,[{key:"createUnwatcher",value:function(e,t){var r=this;return function(){for(var e,n=0;n<r.events.length;n++)(e=r.events[n]).handlers=e.handlers.filter((function(e){return e!==t})),e.handlers.length||(r.events.splice(n,1),n--)}}},{key:"on",value:function(e,t){var r=this.createUnwatcher(e,t),n=this.events.find((function(t){return t.eventName===e}));return n&&n.handlers.includes(t)?r:(n?n.handlers.push(t):this.events.push({eventName:e,handlers:[t]}),r)}},{key:"off",value:function(e,t){this.createUnwatcher(e,t)()}},{key:"dispatch",value:function(e,t){var r=this.events.find((function(t){return t.eventName===e}));if(r){var n=!0,o=!1,i=void 0;try{for(var s,u=r.handlers[Symbol.iterator]();!(n=(s=u.next()).done);n=!0)(0,s.value)(t)}catch(e){o=!0,i=e}finally{try{n||null==u.return||u.return()}finally{if(o)throw i}}}}}]),e}(),d="action-occured",h="action-count-changed",y=function(e){function t(e){var r;return o()(this,t),(r=c()(this,f()(t).call(this))).actions=[],e&&e.forEach((function(e){return r.observeAction(e)})),r.on(d,(function(e){return r.actionTriggered(e)})),r}return v()(t,e),s()(t,[{key:"observeAction",value:function(e){var t=this;if(this.actions.find((function(t){return t.actionName===e.actionName})))throw new Error("UserObserver: action is already observed!");this.actions.push({actionName:e.actionName,count:0,observers:e.triggers?e.triggers.map((function(r){return t.createObserver(e.actionName,r)})):[]})}},{key:"stopActionObserving",value:function(e){this.clearObservers(e),this.actions=this.actions.filter((function(t){return t.actionName!==e}))}},{key:"stopObserving",value:function(){var e=this;this.actions.forEach((function(t){return e.stopActionObserving(t.actionName)}))}},{key:"addObserver",value:function(e,t){this.findActionOrFail(e).observers.push(this.createObserver(e,t))}},{key:"clearObservers",value:function(e,t){for(var r=this,n=this.findActionOrFail(e),o=function(e){var o=n.observers[e];if(t&&!r.areTriggersEqual(o.trigger,t))return i=e,"continue";("string"==typeof o.trigger.element?document.querySelectorAll(o.trigger.element):[o.trigger.element]).forEach((function(e){return e.removeEventListener(o.trigger.event,o.handler)})),n.observers.splice(e,1),i=--e},i=0;i<n.observers.length;i++)o(i)}},{key:"getCount",value:function(e){return this.findActionOrFail(e).count}},{key:"getStats",value:function(){return this.actions.map((function(e){return{actionName:e.actionName,count:e.count}}))}},{key:"actionTriggered",value:function(e){var t=this.findActionOrFail(e);t.count+=1,this.dispatch(h,t.count)}},{key:"findActionOrFail",value:function(e){var t=this.actions.find((function(t){return t.actionName===e}));if(!t)throw new Error("UserObserver: action ".concat(e," not found!"));return t}},{key:"areTriggersEqual",value:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=t[0];return t.slice(1).every((function(e){var t=e.element===n.element&&e.event===n.event;return n=e,t}))}},{key:"createObserver",value:function(e,t){var r=this,n=function(){r.dispatch(d,e)};"string"==typeof t.element?document.querySelectorAll(t.element).forEach((function(e){e.addEventListener(t.event,n)})):t.element.addEventListener(t.event,n);return{trigger:t,handler:n}}}]),t}(p),b=function(e){function t(e){var r,n=e.observer,i=e.userClasses,s=e.defaultClass;return o()(this,t),(r=c()(this,f()(t).call(this))).observer=void 0,r.userClasses=void 0,r.classifier=function(){return r.userClasses[0]},r.currentUserClass=null,r.observer=n,r.userClasses=i,s&&(r.currentUserClass=s),n.on(h,(function(){return r.classify()})),r}return v()(t,e),s()(t,[{key:"use",value:function(e){this.classifier=e}},{key:"classify",value:function(){this.currentUserClass=this.classifier(this.observer,this.currentUserClass),this.dispatch("user-classified",this.currentUserClass)}}]),t}(p);r.d(t,"UIPersonalizer",(function(){return m}));var m=function(e){var t=e.firstGroup,r=e.secondGroup,n=e.uiChnaged,o={firstGroup:t.theme,secondGroup:r.theme},i=function(e){var t=new y(e.actions),r=new b({observer:t,defaultClass:e.defaultClass,userClasses:e.userClasses});return r.use(e.сlassifier),function(e,t){e.on("user-classified",t)}(r,e.renderer),{observer:t,"сlassifier":r}}({actions:[{actionName:"firstGroup"},{actionName:"secondGroup"}],defaultClass:"firstGroup",userClasses:["firstGroup","secondGroup"],"сlassifier":function(e,t){var r=e.getCount("firstGroup"),n=e.getCount("secondGroup");return r||n?r>1.5*n?"firstGroup":n>1.5*r?"secondGroup":t||"firstGroup":t||"firstGroup"},renderer:function(e){(function(e){var t=document.documentElement;Object.getOwnPropertyNames(e).forEach((function(r){var n=e[r];t.style.setProperty("--".concat(r),n.toString())}))})(o[e]),n&&n(e)}}).observer;return{observer:i,observe:function(){i.addObserver("firstGroup",{element:t.triggerSelector,event:"click"}),i.addObserver("secondGroup",{element:r.triggerSelector,event:"click"})}}};window.UIPersonalizer=m}]);